(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-184c04e2"],{"0f5f":function(e,t,n){(function(t,n){e.exports=n()})(0,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports={type:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},isObject:function(e,t){return t?"object"===this.type(e):e&&"object"===("undefined"===typeof e?"undefined":o(e))},isFormData:function(e){return"undefined"!==typeof FormData&&e instanceof FormData},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},encode:function(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")},formatParams:function(e){var t="",n=!0,o=this;if(!this.isObject(e))return e;function a(e,r){var i=o.encode,s=o.type(e);if("array"==s)e.forEach(function(e,t){o.isObject(e)||(t=""),a(e,r+"%5B"+t+"%5D")});else if("object"==s)for(var c in e)a(e[c],r?r+"%5B"+i(c)+"%5D":i(c));else n||(t+="&"),n=!1,t+=r+"="+i(e)}return a(e,""),t},merge:function(e,t){for(var n in t)e.hasOwnProperty(n)?this.isObject(t[n],1)&&this.isObject(e[n],1)&&this.merge(e[n],t[n]):e[n]=t[n];return e}}},,function(e,t,n){var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=n(0),i="undefined"!==typeof document,s=function(){function e(t){function n(e){var t=void 0,n=void 0;function o(){e.p=t=n=null}r.merge(e,{lock:function(){t||(e.p=new Promise(function(e,o){t=e,n=o}))},unlock:function(){t&&(t(),o())},clear:function(){n&&(n("cancel"),o())}})}a(this,e),this.engine=t||XMLHttpRequest,this.default=this;var o=this.interceptors={response:{use:function(e,t){this.handler=e,this.onerror=t}},request:{use:function(e){this.handler=e}}},i=o.request,s=o.response;n(s),n(i),this.config={method:"GET",baseURL:"",headers:{},timeout:0,params:{},parseJson:!0,withCredentials:!1}}return o(e,[{key:"request",value:function(e,t,n){var o=this,a=new this.engine,s="Content-Type",c=s.toLowerCase(),l=this.interceptors,u=l.request,d=l.response,f=u.handler,p=new Promise(function(l,p){function m(e){return e&&e.then&&e.catch}function h(e,t){e?e.then(function(){t()}):t()}function g(n){t=n.body,e=r.trim(n.url);var o=r.trim(n.baseURL||"");if(e||!i||o||(e=location.href),0!==e.indexOf("http")){var u="/"===e[0];if(!o&&i){var f=location.pathname.split("/");f.pop(),o=location.protocol+"//"+location.host+(u?"":f.join("/"))}if("/"!==o[o.length-1]&&(o+="/"),e=o+(u?e.substr(1):e),i){var g=document.createElement("a");g.href=e,e=g.href}}var v=r.trim(n.responseType||""),b=-1!==["GET","HEAD","DELETE","OPTION"].indexOf(n.method),y=r.type(t),w=n.params||{};b&&"object"===y&&(w=r.merge(t,w)),w=r.formatParams(w);var O=[];w&&O.push(w),b&&t&&"string"===y&&O.push(t),O.length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+O.join("&")),a.open(n.method,e);try{a.withCredentials=!!n.withCredentials,a.timeout=n.timeout||0,"stream"!==v&&(a.responseType=v)}catch(S){}var k=n.headers[s]||n.headers[c],j="application/x-www-form-urlencoded";for(var _ in r.trim((k||"").toLowerCase())===j?t=r.formatParams(t):r.isFormData(t)||-1===["object","array"].indexOf(r.type(t))||(j="application/json;charset=utf-8",t=JSON.stringify(t)),k||b||(n.headers[s]=j),n.headers)if(_===s&&r.isFormData(t))delete n.headers[_];else try{a.setRequestHeader(_,n.headers[_])}catch(S){}function x(e,t,o){h(d.p,function(){if(e){o&&(t.request=n);var a=e.call(d,t,Promise);t=void 0===a?t:a}m(t)||(t=Promise[0===o?"resolve":"reject"](t)),t.then(function(e){l(e)}).catch(function(e){p(e)})})}function D(e){e.engine=a,x(d.onerror,e,-1)}function C(e,t){this.message=e,this.status=t}a.onload=function(){try{var e=a.response||a.responseText;e&&n.parseJson&&-1!==(a.getResponseHeader(s)||"").indexOf("json")&&!r.isObject(e)&&(e=JSON.parse(e));var t=a.responseHeaders;if(!t){t={};var o=(a.getAllResponseHeaders()||"").split("\r\n");o.pop(),o.forEach(function(e){if(e){var n=e.split(":")[0];t[n]=a.getResponseHeader(n)}})}var i=a.status,c=a.statusText,l={data:e,headers:t,status:i,statusText:c};if(r.merge(l,a._response),i>=200&&i<300||304===i)l.engine=a,l.request=n,x(d.handler,l,0);else{var u=new C(c,i);u.response=l,D(u)}}catch(u){D(new C(u.msg,a.status))}},a.onerror=function(e){D(new C(e.msg||"Network Error",0))},a.ontimeout=function(){D(new C("timeout [ "+a.timeout+"ms ]",1))},a._options=n,setTimeout(function(){a.send(b?null:t)},0)}r.isObject(e)&&(n=e,e=n.url),n=n||{},n.headers=n.headers||{},h(u.p,function(){r.merge(n,JSON.parse(JSON.stringify(o.config)));var a=n.headers;a[s]=a[s]||a[c]||"",delete a[c],n.body=t||n.body,e=r.trim(e||""),n.method=n.method.toUpperCase(),n.url=e;var i=n;f&&(i=f.call(u,n,Promise)||n),m(i)||(i=Promise.resolve(i)),i.then(function(e){e===n?g(e):l(e)},function(e){p(e)})})});return p.engine=a,p}},{key:"all",value:function(e){return Promise.all(e)}},{key:"spread",value:function(e){return function(t){return e.apply(null,t)}}}]),e}();s.default=s,["get","post","put","patch","head","delete"].forEach(function(e){s.prototype[e]=function(t,n,o){return this.request(t,n,r.merge({method:e},o))}}),["lock","unlock","clear"].forEach(function(e){s.prototype[e]=function(){this.interceptors.request[e]()}}),e.exports=s}])})},"8c8e":function(e,t,n){},"9b7e":function(e,t,n){},a648:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("van-dialog",{attrs:{title:"正在下载中",showConfirmButton:!1},model:{value:e.showLoadingDialog,callback:function(t){e.showLoadingDialog=t},expression:"showLoadingDialog"}}),e._l(e.works,function(t){return n("van-card",{key:t.tag,attrs:{tag:t.tag+" 号",desc:t.desc,title:t.title,thumb:t.imageURL}},[n("div",{attrs:{slot:"footer"},slot:"footer"},[n("van-button",{staticStyle:{"padding-right":"5px"},attrs:{size:"small",type:"danger",disabled:e.disable_all||t.voted,round:""},on:{click:function(t){return e.show_confirm_vote()}}},[e._v("\n          去投票\n        ")]),n("van-button",{staticStyle:{"padding-left":"5px"},attrs:{size:"small",type:"primary",round:""},on:{click:function(n){return e.show_detail(t.tag)}}},[e._v("查看详情")])],1)])}),n("van-dialog",{attrs:{id:"van-dialog"}}),n("van-dialog",{attrs:{show:e.showContactDialog,"show-cancel-button":"","confirm-button-open-type":"contact",title:"提示",message:e.subname},on:{close:e.onContactDialogClose,cancel:e.onContactDialogClose}}),n("van-actionsheet",{attrs:{title:"选择查看详情方式"},on:{close:function(t){return e.onActionClose()}},model:{value:e.showDetailAction,callback:function(t){e.showDetailAction=t},expression:"showDetailAction"}},[n("div",e._l(e.detailActions,function(t){return n("van-button",{key:t.name,attrs:{size:"large"},on:{click:function(n){return e.onActionSelect(t.name,t.subname)}}},[e._v("\n            "+e._s(t.name)+"\n          ")])}),1)]),n("van-notify",{attrs:{id:"van-notify"}}),n("van-toast",{attrs:{id:"van-toast"}})],2)},a=[],r=n("bd86"),i=(n("ac1e"),n("543e")),s=(n("68ef"),n("9b7e"),n("ea82"),n("2638")),c=n.n(s),l=n("a142"),u=n("ba31"),d=n("6aa9"),f=Object(l["i"])("tag"),p=f[0],m=f[1],h={danger:d["d"],primary:d["a"],success:d["c"]};function g(e,t,n,o){var a,r=t.type,i=t.mark,s=t.plain,l=t.round,f=t.size,p=t.color||r&&h[r]||d["b"],g=s?"color":"backgroundColor",v=(a={},a[g]=p,a);t.textColor&&(v.color=t.textColor);var b={mark:i,plain:s,round:l};return f&&(b[f]=f),e("span",c()([{style:v,class:[m(b),{"van-hairline--surround":s}]},Object(u["b"])(o,!0)]),[n["default"]&&n["default"]()])}g.props={size:String,type:String,mark:Boolean,color:String,plain:Boolean,round:Boolean,textColor:String};var v=p(g),b=Object(l["i"])("card"),y=b[0],w=b[1];function O(e,t,n,o){var a=t.thumb,r=n.thumb||a,i=n.tag||t.tag,s=n.num||Object(l["c"])(t.num),d=n.price||Object(l["c"])(t.price),f=n["origin-price"]||Object(l["c"])(t.originPrice),p=s||d||f,m=r&&e("a",{attrs:{href:t.thumbLink},class:w("thumb")},[n.thumb?n.thumb():t.lazyLoad?e("img",{class:w("img"),directives:[{name:"lazy",value:a}]}):e("img",{class:w("img"),attrs:{src:a}}),i&&e("div",{class:w("tag")},[n.tag?n.tag():e(v,{attrs:{mark:!0,type:"danger"}},[t.tag])])]),h=n.title?n.title():t.title&&e("div",{class:w("title")},[t.title]),g=n.desc?n.desc():t.desc&&e("div",{class:[w("desc"),""]},[t.desc]),b=d&&e("div",{class:w("price")},[n.price?n.price():t.currency+" "+t.price]),y=f&&e("div",{class:w("origin-price")},[n["origin-price"]?n["origin-price"]():t.currency+" "+t.originPrice]),O=s&&e("div",{class:w("num")},[n.num?n.num():"x "+t.num]),k=n.footer&&e("div",{class:w("footer")},[n.footer()]);return e("div",c()([{class:w()},Object(u["b"])(o,!0)]),[e("div",{class:w("header")},[m,e("div",{class:w("content",{centered:t.centered})},[h,g,n.tags&&n.tags(),p&&e("div",{class:"van-card__bottom"},[b,y,O])])]),k])}O.props={tag:String,desc:String,thumb:String,title:String,centered:Boolean,lazyLoad:Boolean,thumbLink:String,num:[Number,String],price:[Number,String],originPrice:[Number,String],currency:{type:String,default:"¥"}};var k=y(O),j=(n("4d75"),n("8c8e"),n("c31d")),_=n("6605"),x=n("ad06"),D=n("e41f"),C=Object(l["i"])("actionsheet"),S=C[0],L=C[1];function T(e,t,n,o){var a=t.title,r=t.cancelText,s=function(){Object(u["a"])(o,"input",!1),Object(u["a"])(o,"cancel")},l=function(){return e("div",{class:[L("header"),"van-hairline--top-bottom"]},[a,e(x["a"],{attrs:{name:"close"},class:L("close"),on:{click:s}})])},d=function(t,n){return e("div",{class:[L("item",{disabled:t.disabled||t.loading}),t.className,"van-hairline--top"],on:{click:function(e){e.stopPropagation(),t.disabled||t.loading||(t.callback&&t.callback(t),Object(u["a"])(o,"select",t,n))}}},[t.loading?e(i["a"],{class:L("loading"),attrs:{size:"20px"}}):[e("span",{class:L("name")},[t.name]),t.subname&&e("span",{class:L("subname")},[t.subname])]])};return e(D["a"],c()([{class:L({"safe-area-inset-bottom":t.safeAreaInsetBottom}),attrs:{value:t.value,position:"bottom",overlay:t.overlay,lazyRender:t.lazyRender,getContainer:t.getContainer,closeOnClickOverlay:t.closeOnClickOverlay},on:{input:function(e){Object(u["a"])(o,"input",e)}}},Object(u["b"])(o)]),[a?l():t.actions.map(d),n["default"]&&e("div",{class:L("content")},[n["default"]()]),r&&e("div",{class:L("cancel"),on:{click:s}},[r])])}T.props=Object(j["a"])({},_["a"].props,{title:String,actions:Array,cancelText:String,safeAreaInsetBottom:Boolean,overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!0}});var P,A=S(T),B=(n("e7e5"),n("d399")),E=(n("e17f"),n("2241")),q=(n("66b9"),n("b650")),z=(n("9a83"),n("f564")),N=n("2b0e");N["a"].use(z["a"]),N["a"].use(q["a"]),N["a"].use(E["a"]),N["a"].use(B["a"]),N["a"].use(A),N["a"].use(k);var R=n("f54a"),J={components:(P={},Object(r["a"])(P,z["a"].name,z["a"]),Object(r["a"])(P,E["a"].name,E["a"]),Object(r["a"])(P,B["a"].name,B["a"]),Object(r["a"])(P,i["a"].name,i["a"]),Object(r["a"])(P,A.name,A),P),data:function(){return{showLoadingDialog:!0,deploy_domain:"https://vote.ilingyue.cn",selectedWorkTag:"",showDetailAction:!1,showContactDialog:!1,disable_all:!1,max_votes:3,voted:0,subname:"",vote_url:"https://mp.weixin.qq.com/s/xBss_zKOtVrYdyfcZDU0Yg",works:{}}},props:{userId:String},onLoad:function(e){},mounted:function(){Object(z["a"])("登录成功: "+this.userId);var e=this;R.post(this.deploy_domain+"/getWorks",{userId:this.userId}).then(function(t){if(console.log(t),e.showLoadingDialog=!1,"success"===t["data"]["code"]){e.works=t["data"]["data"]["works"],e.max_votes=t["data"]["data"]["max_votes"],Object(z["a"])("获取作品成功");var n=0,o=e.works;for(var a in e.works)o[a]["voted"]?(n+=1,o[a]["btn_text"]="已投票"):o[a]["btn_text"]="直接投票";n>=e.max_votes&&(e.disable_all=!0),e.voted=n,e.works=o}else Object(z["a"])("获取作品失败"+t["data"]["data"])}).catch(function(t){console.log(t),e.showLoadingDialog=!1,Object(z["a"])("获取作品失败: "+JSON.stringify(t))})},computed:{detailActions:function(){return[{name:"pdf 查看",subname:"在小程序内打开作品的 pdf 版本介绍"},{name:"作品链接",subname:"查看作品原始链接"}]}},methods:{show_confirm_vote:function(){window.open(this.vote_url,"_blank")},show_detail:function(e){this.selectedWorkTag=e,this.showLoadingDialog=!0;var t=this.works[this.selectedWorkTag]["pdf_url"];this.$router.push({name:"pdf",params:{pdf_src:t}}),this.showLoadingDialog=!1},onActionClose:function(){this.showDetailAction=!1,this.selectedWorkTag="",Object(B["a"])("取消查看详情")},onContactDialogClose:function(){this.showContactDialog=!1},onActionSelect:function(e,t){if(this.showDetailAction=!1,"pdf 查看"===e){this.showLoadingDialog=!0;var n=this.works[this.selectedWorkTag]["pdf_url"];this.$router.push({name:"pdf",params:{pdf_src:n,openid:this.openid}}),this.showLoadingDialog=!1}else if("作品链接"===e){Object(z["a"])("正在转跳到作品链接");n=this.works[this.selectedWorkTag]["origin_url"];window.open(n,"_blank")}this.selectedWorkTag=""}}},I=J,W=n("2877"),H=Object(W["a"])(I,o,a,!1,null,null,null);t["default"]=H.exports},ea82:function(e,t,n){},f54a:function(e,t,n){var o=n("0f5f"),a=new o;e.exports=a}}]);
//# sourceMappingURL=chunk-184c04e2.477ea237.js.map